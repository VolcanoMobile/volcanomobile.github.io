var jqueryMusicMidiChannelsConfigChannel=function(b){this.vars={programNumber:0,controlChanges:new Array(),notesType:jqueryMusicMidiChannelsConfigChannel.NOTES_TYPES_NOTE,changed:null};
var a=this;this.construct=function(c){$.extend(this.vars,c);this.initControlChanges()
};this.valuesChanged=function(){if(this.vars.changed!=null){this.vars.changed(this.vars)
}};this.getNotesType=function(){return this.vars.notesType};this.setNotesType=function(c){this.vars.notesType=c
};this.getProgramNumber=function(){return this.vars.programNumber};this.setProgramNumber=function(c){this.vars.programNumber=c
};this.initControlChanges=function(){this.vars.controlChanges=new Array();for(var c=0;
c<128;c++){this.vars.controlChanges[c]=new jqueryMusicMidiChannelsConfigChannelCc()
}this.vars.controlChanges[7].setValue(127);this.vars.controlChanges[10].setValue(64);
this.vars.controlChanges[11].setValue(127)};this.getCcCount=function(){if(this.vars.controlChanges==null){this.initControlChanges()
}return this.vars.controlChanges.length};this.getCc=function(c){return this.vars.controlChanges[c]
};this.addEvent=function(c){if(this.vars.events==null){this.vars.events=[]}var d={noteValue:36,velocity:127,onChange:null};
$.extend(d,c);this.vars.events[this.vars.events.length]=new jqueryMusicMidiChannelsConfigChannelCc(d)
};this.deleteEvent=function(c){if(this.vars.events==null){this.vars.events=[]}this.vars.events.splice(c,1)
};this.setChanged=function(c){this.vars.changed=c};this.serialize=function(){return JSON.stringify(a)
};this.fixDeserialize=function(){if(this.vars.controlChanges){for(var d=0;d<this.vars.controlChanges.length;
d++){if(this.vars.controlChanges[d]){var e=this.vars.controlChanges[d];var c=new jqueryMusicMidiChannelsConfigChannelCc();
this.vars.controlChanges[d]=Object.assign(c,e)}}}};this.construct(b)};jqueryMusicMidiChannelsConfigChannel.NOTES_TYPES_NOTE=0;
jqueryMusicMidiChannelsConfigChannel.NOTES_TYPES_DRUM=1;var jqueryMusicMidiChannelsConfigChannelCc=function(b){this.vars={value:0};var a=this;
this.construct=function(c){$.extend(this.vars,c)};this.getCcValue=function(){return this.vars.value
};this.setValue=function(c){this.vars.value=c};this.serialize=function(){return JSON.stringify(a)
};this.construct(b)};var jqueryMusicMidiChannelsConfigSettingsLayout=function(d){var f={id:null,classePrefix:"jdc",notes:[36,38,39,50,47,43,42,46,51],notesText:(typeof jqueryMusicMidiSimpleDrumNoteNames==="undefined")?null:jqueryMusicMidiSimpleDrumNoteNames,notesTextShort:(typeof jqueryMusicMidiSimpleDrumNoteNamesShort==="undefined")?null:jqueryMusicMidiSimpleDrumNoteNamesShort,channelsConfig:null,onNumberOfChannelsChange:null};
var c=this;var a=null;var e=null;var b=null;this.construct=function(g){$.extend(f,g);
if(f.notesText==null){f.notesText=new Array()}if(f.notesTextShort==null){f.notesTextShort=new Array()
}this.rootElement=$("#"+f.id+"");this.createLayout()};this.valuesChanged=function(){if(f.callbackValuesChanged!=null){f.callbackValuesChanged(f)
}};this.createLayout=function(){$.ajax({url:"./settings.html",dataType:"html",cache:false,success:function(g){c.rootElement.html(g);
c.initInputs()}})};this.initInputs=function(){var h=this.rootElement.find("#rowValueText");
var g=this.rootElement.find("#numberOfChannelsDecreaseButton");g.click(function(){var j=f.channelsConfig.getNumberOfChannels()-1;
if(f.onNumberOfChannelsChange){f.onNumberOfChannelsChange(j)}c.refreshRowsValues()
});var i=this.rootElement.find("#numberOfChannelsIncreaseButton");i.click(function(){var j=f.channelsConfig.getNumberOfChannels()+1;
if(f.onNumberOfChannelsChange){f.onNumberOfChannelsChange(j)}c.refreshRowsValues()
});this.refreshInputsValues()};this.refreshInputsValues=function(){this.refreshRowsValues()
};this.refreshRowsValues=function(){var g=this.rootElement.find("#rowValueText");
g.html(f.channelsConfig.getNumberOfChannels())};this.getId=function(){return f.id
};this.setChannelsConfig=function(g){f.channelsConfig=g;this.refreshInputsValues()
};this.construct(d)};var channelsConfig;var channelsConfigLayout;var channelsConfigSettingsLayout;var channelsConfigChannelSettingsLayout;
var myMidiAccessApi;jQuery(document).ready(function(){createDefaultProject();loadJsonUrlchannelsConfig("./catalog/default.json");
channelsConfigLayout=new jqueryMusicMidiChannelsConfigChannelsLayout({id:"channelsConfigLayout",channelsConfig:channelsConfig,onChannelClickCallback:function(a){channelsConfig.setSelectedChannel(a)
}});channelsConfigSettingsLayout=new jqueryMusicMidiChannelsConfigSettingsLayout({id:"settingsLayout",channelsConfig:channelsConfig,onNumberOfChannelsChange:function(a){channelsConfig.setNumberOfChannels(a)
}});channelsConfigChannelSettingsLayout=new jqueryMusicMidiChannelsConfigChannelSettingsLayout({id:"channelSettingsLayout",channelsConfig:channelsConfig,onNotesTypeChange:function(b,a){channelsConfig.setChannelNotesType(b,a)
},onProgramChange:function(b,a){console.log("index channelsConfigChannelSettingsLayout onProgramChange() channelNumber: "+b+", programNumber: "+a);
channelsConfig.setChannelProgramNumber(b,a)},onCcValueChange:function(c,a,b){channelsConfig.setChannelCcValue(c,a,b)
},onAddCc:function(a){channelsConfig.enableControlChange(a,true)}});myMidiAccessApi=new jMidiAccessApi({initCallback:function(a){jQuery("#midiNotSupported").css("display",a.midiSupported?"none":"block");
if(a.midiSupported){devicesChanged(a)}},onRequestMidiAccessSuccess:function(a){jQuery("#requestMidiAccessSuccess").css("display","inline-block");
jQuery("#requestMidiAccessSuccess").delay(3000).fadeOut();if(a.midiSupported){devicesChanged(a)
}},onRequestMIDIAccessFailure:function(){jQuery("#requestMIDIAccessFailure").css("display","inline-block");
jQuery("#requestMIDIAccessFailure").delay(3000).fadeOut()},deviceStateChangeCallback:function(a,b){devicesChanged(b)
},portConnectedCallback:function(a,b){devicesChanged(b)},portDisconnectedCallback:function(a,b){devicesChanged(b)
},receiveCallback:function(a){receiveMidiEvent(MIDIMessageEventParser.parseEvent(a));
myMidiAccessApi.send(a)}});$(window).keypress(function(a){if(a.which===48){channelsConfig.setSelectedChannel(9)
}else{if(a.which>=49&&a.which<=57){channelsConfig.setSelectedChannel(a.which-49)}else{if(a.which===111){jQuery("#openFilePanel").slideToggle()
}}}});jQuery("#newProjectButton").click(function(){createDefaultProject()});jQuery("#catalogButton").click(function(){loadCatalogLayout()
});jQuery("#sendButton").click(function(){sendMidiChannelsConfig();$.toast({text:"<span class='fa fa-check'></span> MIDI Config sent",hideAfter:1000,showHideTransition:"fade",position:"top-center",loader:false,bgColor:"#28a745"})
});jQuery("#serializeButton").click(function(){download("the_file.json",channelsConfig.serialize())
});jQuery(".toggleMidiPanelButton").click(function(){jQuery("#midiPanel").slideToggle()
});jQuery(".toggleChannelsConfigSettingsPanelButton").click(function(){jQuery("#controlerSettingsPanel").slideToggle()
});jQuery(".toogleOpenFilePanel").click(function(){jQuery("#openFilePanel").slideToggle()
});setupCatalogLayout()});function devicesChanged(a){listMidiInputDevices(a.midiAccess);
listMidiOutputDevices(a.midiAccess)}function listMidiInputDevices(a){var b=jQuery("#midiInputs");
b.html("");if(a!=null&&a.inputs!=null){a.inputs.forEach(function(c,e){var d="";d+=""+(c.onmidimessage?"<span class='fa fa-check text-success'></span>":"<span class='fa fa-plug'></span>")+" ";
d+=c.name;d+=" <small>("+c.id+")</small>";b.append(jQuery("<button/>",{inputPortName:c.name,portConnected:c.onmidimessage?1:0,"class":"list-group-item  list-group-item-action"}).append(jQuery("<div/>",{}).html(d)).click(function(){var f=jQuery(this).attr("inputPortName");
if(parseInt(jQuery(this).attr("portConnected"))){myMidiAccessApi.unbindInputPortByName(f)
}else{myMidiAccessApi.bindInputPortByName(f)}}))})}}function listMidiOutputDevices(a){var b=jQuery("#midiOutputs");
b.html("");if(a!=null&&a.outputs!=null){a.outputs.forEach(function(e,d){var c="";
c+=""+(myMidiAccessApi.isOutputConnectedById(e.id)?"<span class='fa fa-check text-success'></span>":"<span class='fa fa-plug'></span>")+" ";
c+=e.name;c+=" <small>("+e.id+")</small>";b.append(jQuery("<button/>",{"class":"list-group-item list-group-item-action",outputPortName:e.name,portConnected:myMidiAccessApi.isOutputConnectedById(e.id)?1:0}).html(c).click(function(){var f=jQuery(this).attr("outputPortName");
if(parseInt(jQuery(this).attr("portConnected"))){myMidiAccessApi.disconnectOutputPortByName(f)
}else{myMidiAccessApi.connectOutputPortByName(f)}}))})}}function download(a,c){var b=document.createElement("a");
b.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(c));b.setAttribute("download",a);
b.style.display="none";document.body.appendChild(b);b.click();document.body.removeChild(b)
}function setupCatalogLayout(){jQuery("#catalogLayout").click(function(){jQuery(this).css("display","none")
});jQuery("#catalogLayout > *").click(function(){return false})}function loadCatalogLayout(){var b=jQuery("#catalogLayout");
b.css("display","block");var a=jQuery("#catalogProjectsLayout");a.html("");$.ajax({url:"./catalog/catalog.json",dataType:"json",cache:false,success:function(c){c.projects.forEach(function(e,d){a.append(jQuery("<button/>",{"class":"list-group-item list-group-item-action",filename:e.filename}).html(e.name).click(function(){var f=jQuery(this).attr("filename");
loadJsonUrlchannelsConfig("./catalog/"+f)}))})}})}function createDefaultProject(){channelsConfig=new jqueryMusicMidiChannelsConfig();
channelsConfigLoaded()}function loadJsonStringChannelsConfig(b){var a=JSON.parse(b);
var c=new jqueryMusicMidiChannelsConfig();channelsConfig=Object.assign(c,a);channelsConfigLoaded()
}function channelsConfigLoaded(){channelsConfig.fixDeserialize();addChannelsConfigListeners();
if(channelsConfigLayout!=null){channelsConfigLayout.setChannelsConfig(channelsConfig,true,true)
}if(channelsConfigSettingsLayout!=null){channelsConfigSettingsLayout.setChannelsConfig(channelsConfig,true,true)
}if(channelsConfigChannelSettingsLayout!=null){channelsConfigChannelSettingsLayout.setChannelsConfig(channelsConfig,true,true)
}}function loadJsonUrlchannelsConfig(a){jQuery.ajax({url:a,dataType:"text",cache:false,success:function(b){loadJsonStringChannelsConfig(b)
}})}function addChannelsConfigListeners(){channelsConfig.setOnNumberOfChannelsChanged(function(a){channelsConfigLayout.setChannelsConfig(channelsConfig,false,false)
});channelsConfig.setOnSelectedChannelChanged(function(a){showChannelSettingsLayout(a);
channelsConfigLayout.setSelectedChannel(channelsConfig.getSelectedChannel())});channelsConfig.setOnEnableControlChangesChanged(function(){channelsConfigChannelSettingsLayout.initCcLayouts()
});channelsConfig.setOnChannelNotesTypeChanged(function(){channelsConfigChannelSettingsLayout.refreshProgramInputOptions()
});channelsConfig.setOnChannelProgramChanged(function(b,a){sendProgramChange(b,a)
});channelsConfig.setOnChannelCcValueChanged(function(c,a,b){channelsConfigChannelSettingsLayout.refreshCcValues(c,a);
sendControlChange(c,a,b)})}$("#jsonInputFile").on("change",function(){var a=new FileReader();
a.onload=function(){var b=a.result;loadJsonStringChannelsConfig(b)};a.readAsText($("#jsonInputFile").prop("files")[0])
});function showChannelSettingsLayout(a){channelsConfigChannelSettingsLayout.setChannelIndex(a);
if(jQuery("#channelSettingsPanel").css("display")=="none"){jQuery("#channelSettingsPanel").slideToggle()
}}function receiveMidiEvent(c){for(var b in c){var a=c[b];if(a.type=="controlChange"){channelsConfig.setChannelCcValue(a.channel,a.controllerNumber,a.controllerValue);
channelsConfigChannelSettingsLayout.refreshCcValues(a.channel,a.controllerNumber)
}}}function sendMidiChannelsConfig(){for(var b=0;b<channelsConfig.getChannelsCount();
b++){var e=channelsConfig.getChannel(b);sendProgramChange(b,e.getProgramNumber());
for(var d=0;d<channelsConfig.getEnableControlChangesCount();d++){var c=channelsConfig.getEnableControlChange(d);
var a=e.getCc(c);sendControlChange(b,c,a.getCcValue())}}}function sendControlChange(b,c){var d=channelsConfig.getChannel(channelNumber);
var a=d.getCc(ccNumber);sendControlChange(b,c,a.getValue())}function sendControlChange(a,b,c){myMidiAccessApi.send({receivedTime:window.performance.now(),data:[176+(0+a),0+b,0+c]})
}function sendProgramChange(a,b){myMidiAccessApi.send({receivedTime:window.performance.now(),data:[192+(0+a),0+b]})
};var jqueryMusicMidiChannelsConfigToggleCcs=[64,65,66,67,68,69];var jqueryMusicMidiChannelsConfig=function(b){this.vars={numberOfChannels:16,channels:null,selectedChannel:0,enableControlChanges:[7,10,11,65],onNumberOfChannelsChanged:null,onSelectedChannelChanged:null,onEnableControlChangesChanged:null,onChannelNotesTypeChanged:null,onChannelProgramChanged:null,onChannelCcValueChanged:null};
var a=this;this.construct=function(c){$.extend(this.vars,c);this.initChannels()};
this.valuesChanged=function(){if(this.vars.callbackValuesChanged!=null){this.vars.callbackValuesChanged(this.vars)
}};this.initChannels=function(){this.vars.channels=new Array();for(var c=0;c<this.vars.numberOfChannels;
c++){this.vars.channels[c]=new jqueryMusicMidiChannelsConfigChannel()}};this.getNumberOfChannels=function(){return this.vars.numberOfChannels
};this.setNumberOfChannels=function(c){if(c>0&&c<=32){this.vars.numberOfChannels=c;
while(this.vars.channels.length<this.vars.numberOfChannels){this.vars.channels.push(new jqueryMusicMidiChannelsConfigChannel())
}if(this.vars.onNumberOfChannelsChanged!=null){this.vars.onNumberOfChannelsChanged(this.vars.numberOfChannels)
}}};this.getChannel=function(c){return this.vars.channels[c]};this.setChannelNotesType=function(d,c){var e=this.getChannel(d);
e.setNotesType(c);if(this.vars.onChannelNotesTypeChanged!=null){this.vars.onChannelNotesTypeChanged()
}};this.setChannelProgramNumber=function(c,d){var e=this.getChannel(c);e.setProgramNumber(d);
if(this.vars.onChannelProgramChanged!=null){this.vars.onChannelProgramChanged(c,e.getProgramNumber())
}};this.getEnableControlChanges=function(){return this.vars.enableControlChanges};
this.getEnableControlChangesCount=function(){return this.vars.enableControlChanges.length
};this.getEnableControlChange=function(c){return this.vars.enableControlChanges[c]
};this.getEnableCcFromCcNumber=function(c){return this.vars.enableControlChanges.indexOf(c)
};this.enableControlChange=function(d,c){d=parseInt(d);if(c){if(this.vars.enableControlChanges.indexOf(d)<0){this.vars.enableControlChanges.push(d);
this.vars.enableControlChanges.sort(function(f,e){return f-e})}}else{this.vars.enableControlChanges.remove(d)
}if(this.vars.onEnableControlChangesChanged!=null){this.vars.onEnableControlChangesChanged()
}};this.setChannelCcValue=function(d,e,g){var f=this.getChannel(d);var c=f.getCc(e);
c.setValue(g);if(this.vars.onChannelCcValueChanged!=null){this.vars.onChannelCcValueChanged(d,e,g)
}};this.getChannels=function(){return this.vars.channels};this.getChannelsCount=function(){return this.vars.channels.length
};this.getChannel=function(c){return this.vars.channels[c]};this.getSelectedChannel=function(c){return this.vars.selectedChannel
};this.setSelectedChannel=function(c){this.vars.selectedChannel=c;if(this.vars.onSelectedChannelChanged!=null){this.vars.onSelectedChannelChanged(this.vars.selectedChannel)
}};this.setOnNumberOfChannelsChanged=function(c){this.vars.onNumberOfChannelsChanged=c
};this.setOnSelectedChannelChanged=function(c){this.vars.onSelectedChannelChanged=c
};this.setOnEnableControlChangesChanged=function(c){this.vars.onEnableControlChangesChanged=c
};this.setOnChannelNotesTypeChanged=function(c){this.vars.onChannelNotesTypeChanged=c
};this.setOnChannelProgramChanged=function(c){this.vars.onChannelProgramChanged=c
};this.setOnChannelCcValueChanged=function(c){this.vars.onChannelCcValueChanged=c
};this.serialize=function(){return JSON.stringify(a)};this.serialize=function(){return JSON.stringify(a)
};this.fixDeserialize=function(){for(var d=0;d<this.vars.numberOfChannels;d++){if(this.vars.channels[d]){var e=this.vars.channels[d];
var c=new jqueryMusicMidiChannelsConfigChannel();this.vars.channels[d]=Object.assign(c,e);
this.vars.channels[d].fixDeserialize()}}};this.construct(b)};var jqueryMusicMidiChannelsConfigChannelsLayout=function(f){var h={id:null,classePrefix:"jcc",channelsChannelMuteClass:"channels-channel-mute",notes:[36,38,39,50,47,43,42,46,51],notesText:(typeof gmStringDrumNotes==="undefined")?null:gmStringDrumNotes,notesTextShort:(typeof gmStringDrumNotesShort==="undefined")?null:gmStringDrumNotesShort,channelsConfig:null,onChannelClickCallback:null};
var d=this;var a=null;var e=null;var g=null;var c=null;var b=null;this.construct=function(i){$.extend(h,i);
if(h.notesText==null){h.notesText=new Array()}if(h.notesTextShort==null){h.notesTextShort=new Array()
}this.rootElement=$("#"+h.id+"");this.createMainLayout()};this.valuesChanged=function(){if(h.callbackValuesChanged!=null){h.callbackValuesChanged(h)
}};this.createMainLayout=function(){this.mainLayout=$("<div/>",{id:h.id+"-main-layout","class":h.classePrefix+"-main-layout"}).appendTo(this.rootElement);
this.createContentLayout()};this.createContentLayout=function(){this.contentLayout=$("<div/>",{id:h.id+"-content-layout","class":h.classePrefix+"-content-layout"}).appendTo(this.mainLayout);
this.createChannelsLayout()};this.createChannelsLayout=function(){this.channelsLayout=$("<div/>",{id:h.id+"-channels-layout",style:"display: inline;","class":h.classePrefix+"-channels-layout btn-group"}).appendTo(this.contentLayout);
this.createChannelsLayouts(0)};this.createChannelsLayouts=function(j){this.channelsLayout.html("");
for(var i=0;i<h.channelsConfig.getNumberOfChannels();i++){this.createChannelLayout(i)
}this.setSelectedChannel(j)};this.createChannelLayout=function(i){var j=h.channelsConfig.getChannel(i);
var m=$("<div/>",{id:h.id+"-channels-channel-"+i,"class":h.classePrefix+"-channels-channel btn btn-primary"}).click(function(){h.onChannelClickCallback(i);
d.setSelectedChannel(i)});var k=$("<div/>",{"class":h.classePrefix+"-channels-channel-content"});
m.append(k);var l=$("<span/>",{"class":h.classePrefix+"-channels-channel-label"}).html("Channel "+i);
k.append(l);this.channelsLayout.append(m);this.refreshChannelState(i)};this.refreshChannelsState=function(){for(var i=0;
i<h.channelsConfig.getChannelsCount();i++){this.refreshChannelState(i)}};this.refreshChannelState=function(k){var o=h.channelsConfig.getChannel(k);
var j=(k+1);var n="Channel "+k;var p=h.id+"-channels-channel-"+k;var i=this.channelsLayout.find("#"+p);
i.attr("title",n);var m=h.classePrefix+"-channels-channel-label";var l=i.find("."+m);
l.html(j)};this.getId=function(){return h.id};this.setSelectedChannel=function(k){for(var i=0;
i<h.channelsConfig.getNumberOfChannels();i++){var j=this.channelsLayout.children().eq(i);
if(i==k){j.addClass("active")}else{j.removeClass("active")}}};this.setChannelsConfig=function(i){h.channelsConfig=i;
this.createChannelsLayouts(h.channelsConfig.getSelectedChannel())};this.construct(f)
};var jqueryMusicMidiChannelsConfigChannelSettingsLayout=function(i){var f={id:null,classePrefix:"jcc",channelIndex:0,notes:[36,38,39,50,47,43,42,46,51],controlChangesText:(typeof gmStringsControlChanges==="undefined")?null:gmStringsControlChanges,programsText:(typeof gmStringsPrograms==="undefined")?null:gmStringsPrograms,drumProgramsText:(typeof gmStringsDrumPrograms==="undefined")?null:gmStringsDrumPrograms,channelsConfig:null,onNotesTypeChange:null,onProgramChange:null,onAddCc:null,onCcValueChange:null};
var g=this;var b=null;var a=null;var d=null;var e=null;var c=null;var h=null;this.construct=function(j){$.extend(f,j);
if(f.notesText==null){f.notesText=new Array()}if(f.notesTextShort==null){f.notesTextShort=new Array()
}this.rootElement=$("#"+f.id+"");this.createLayout()};this.valuesChanged=function(){if(f.callbackValuesChanged!=null){f.callbackValuesChanged(f)
}};this.createLayout=function(){$.ajax({url:"./channel_settings.html",dataType:"html",cache:false,success:function(j){g.rootElement.html(j);
g.initLayout()}})};this.initLayout=function(){this.ccTemplateHtml=this.rootElement.find(".controllers-cc-template").html();
this.ccToggleTemplateHtml=this.rootElement.find(".controllers-cc-toggle-template").html();
this.controllersLayout=this.rootElement.find(".controllers-layout");$("#"+f.id+" .addPadEvent").click(function(){if(f.onAddPadEvent){f.onAddPadEvent(f.channelIndex,f.columnIndex)
}});this.refreshChannelValues();this.initTypeInput();this.initProgramInput();this.initCcLayouts();
this.initAddCcLayouts()};this.refreshChannelValues=function(){var k=this.rootElement.find(".channelSettingsTitle");
var j=f.channelsConfig.getChannel(f.channelIndex);k.html("Channel "+(f.channelIndex+1))
};this.initTypeInput=function(){var k=g.rootElement.find(".notesTypeSelect");for(var j=0;
j<2;j++){k.append(jQuery("<option/>").val(parseInt(j)).html(j==jqueryMusicMidiChannelsConfigChannel.NOTES_TYPES_NOTE?"Notes":"Drum"))
}k.change(function(){if(f.onNotesTypeChange!=null){f.onNotesTypeChange(f.channelIndex,jQuery(this).val())
}});this.refreshTypeInputValue()};this.refreshTypeInputValue=function(){var k=f.channelsConfig.getChannel(f.channelIndex);
if(k){if(k.getProgramNumber()){var j=this.rootElement.find(".notesTypeSelect");j.val(k.getNotesType())
}}};this.initProgramInput=function(){var j=g.rootElement.find(".programSelect");j.change(function(){if(f.onProgramChange!=null){f.onProgramChange(f.channelIndex,jQuery(this).val())
}});this.refreshProgramInputOptions()};this.refreshProgramInputOptions=function(){var l=f.channelsConfig.getChannel(f.channelIndex);
var m=g.rootElement.find(".programSelect");m.html("");for(var k=0;k<128;k++){var j=""+(k+1);
if(l!=null){if(l.getNotesType()==jqueryMusicMidiChannelsConfigChannel.NOTES_TYPES_DRUM){if(k<f.drumProgramsText.length){j+=" "+f.drumProgramsText[k]
}}else{j+=". "+f.programsText[k]}}else{console.log("refreshProgramInputOptions channelObject is NULL. vars.channelIndex: "+f.channelIndex+", "+f.channelsConfig.getChannelsCount())
}m.append(jQuery("<option/>").val(parseInt(k)).html(j))}this.refreshProgramInputValue()
};this.refreshProgramInputValue=function(){var j=f.channelsConfig.getChannel(f.channelIndex);
if(j){if(j.getProgramNumber()){this.rootElement.find(".programSelect").val(j.getProgramNumber())
}}};this.initCcLayouts=function(){var m=this.rootElement.find(".controllers-debug");
m.html("");if(this.controllersLayout!=null){this.controllersLayout.html("");var l=f.channelsConfig.getChannel(f.channelIndex);
var n=f.channelsConfig.getEnableControlChanges();for(var o=0;o<n.length;o++){var k=parseInt(n[o]);
var j=l.getCc(k);if(jqueryMusicMidiChannelsConfigToggleCcs.includes(k)){this.createCcToggleLayout(k,this.controllersLayout)
}else{this.createCcLayout(k,this.controllersLayout)}}}};this.createCcLayout=function(m,j){var n=f.channelsConfig.getChannel(f.channelIndex);
var k=n.getCc(m);var l=jQuery(this.ccTemplateHtml);j.append(l);var o=l.find(".valueRange");
o.on("input",function(){$(this).trigger("change")});o.change(function(){if(f.onCcValueChange!=null){f.onCcValueChange(f.channelIndex,m,jQuery(this).val())
}g.refreshCcLabels(m,j)});this.refreshCcLabels(m,j);this.refreshCcValues(f.channelIndex,m,j)
};this.refreshCcLabels=function(n){if(this.controllersLayout){var o=f.channelsConfig.getChannel(f.channelIndex);
var k=o.getCc(n);var j=channelsConfig.getEnableCcFromCcNumber(n);var m=this.controllersLayout.children().eq(j);
var l=m.find(".ccLabel");l.html(""+n+". "+f.controlChangesText[n]);if(jqueryMusicMidiChannelsConfigToggleCcs.includes(n)){}else{var p=m.find(".ccValue");
p.html(""+k.getCcValue())}}else{console.log("jqueryMusicMidiChannelsConfigLayout::refreshCcLabels() ERROR no parent element... ccNumber: ",n)
}};this.refreshCcValues=function(k,n){if(k==f.channelIndex){var l=f.channelsConfig.getChannel(f.channelIndex);
var o=l.getCc(n);var j=channelsConfig.getEnableCcFromCcNumber(parseInt(n));var r=this.controllersLayout.children().eq(j);
if(jqueryMusicMidiChannelsConfigToggleCcs.includes(n)){var m=r.find(".ccToggleButton");
if(o.getCcValue()<64){m.removeClass("bg-success");m.addClass("bg-dark")}else{m.addClass("bg-success");
m.removeClass("bg-dark")}}else{var q=r.find(".ccValue");q.html(""+o.getCcValue());
var p=r.find(".valueRange");p.val(o.getCcValue())}}};this.createCcToggleLayout=function(n,k){var o=f.channelsConfig.getChannel(f.channelIndex);
var l=o.getCc(n);var m=jQuery(this.ccToggleTemplateHtml);k.append(m);var j=m.find(".ccToggleButton");
j.click(function(){var q=f.channelsConfig.getChannel(f.channelIndex);var p=q.getCc(n);
if(f.onCcValueChange!=null){f.onCcValueChange(f.channelIndex,n,p.getCcValue()<64?127:0)
}g.refreshCcLabels(n,k)});this.refreshCcLabels(n,k);this.refreshCcValues(f.channelIndex,n,k)
};this.initAddCcLayouts=function(){var k=g.rootElement.find(".addCcSelectCc");for(var j=0;
j<128;j++){k.append(jQuery("<option/>").val(parseInt(j)).html(""+j+". "+f.controlChangesText[j]))
}var l=this.rootElement.find(".addCcButton");l.click(function(){var m=g.rootElement.find(".addCcSelectCc");
if(f.onAddCc!=null){f.onAddCc(m.val())}})};this.setChannelIndex=function(j){f.channelIndex=j;
this.refreshChannelValues();this.refreshTypeInputValue();this.refreshProgramInputOptions();
this.initCcLayouts()};this.setChannelsConfig=function(j){f.channelsConfig=j;this.refreshChannelValues();
this.refreshTypeInputValue();this.refreshProgramInputOptions();this.initCcLayouts()
};this.construct(i)};